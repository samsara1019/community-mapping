<!DOCTYPE html>
 <html lang="en">
 <head>
   <title>auth</title>
   <meta charset="UTF-8">
   <link rel="stylesheet" href="mystyle.css">
 </head>
 <!-- Below is the initialization snippet for my Firebase project. It will vary for each project -->
 <script src="https://www.gstatic.com/firebasejs/3.6.4/firebase.js"></script>
 <script src="https://www.gstatic.com/firebasejs/4.1.3/firebase.js"></script>
 <script src='https://cdn.firebase.com/js/client/2.4.0/firebase.js'></script>
 <script src="https://www.gstatic.com/firebasejs/3.0.4/firebase.js"></script>
 <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyCaGDtXtpJCXiZuluebYKZfB3si_7pwBok",
      authDomain: "userproperty-850cf.firebaseapp.com",
      databaseURL: "https://userproperty-850cf.firebaseio.com",
      projectId: "userproperty-850cf",
      storageBucket: "userproperty-850cf.appspot.com",
      messagingSenderId: "132744568545"
    };
    firebase.initializeApp(config);
 </script>

 <body>
   <script>
   // 현재 유저 Uid
   var currentUid = null;
   //userID Token이 바뀔때 발동
   //signs in , signs out할때 사용
   firebase.auth().onAuthStateChanged(function(user) {
    if (user && user.uid != currentUid) {
     currentUid = user.uid;

/*
    var user = firebase.auth().currentUser;
     user.updateProfile({
       displayName: "이윤혜"
     }).then(function(){
       console.log('update');
     }, function(error){
       console.log('no');
     });
*/
     username = user.displayName;
     userlevel = user.level;
     var users = myFirebase.child('users').child(currentUid);


    document.getElementById("info").innerHTML = '<p> 로그인이 완료 되었습니다. ' + username + '님 이메일은 ' + user.email + ' 입니다.</p>';
    users.set({username:username, uid:currentUid, level : 24});

    postButton.style.display = "block";
    textInput.style.display = "block";

    console.log(currentUid);
    } else {
     currentUid = null;
     console.log("no user signed in");
    }
   });

   </script>
   <button id="logout">로그아웃하기</button>
   <button id="tothemap">맵으로가기</button>
   <h1 id="info">로그인이 완료되었습니다.</h1>

   <input id="text" type="text" placeholder="Message"><br/>
   <button id="post">Post</button><br/>
   <div id="results"></div>


   <script language="JavaScript" type="text/javascript" src="app.js?v=<%=System.currentTimeMillis()%>"></script>

</body>
 </html>
